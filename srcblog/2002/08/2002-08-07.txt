Date: 2002-08-07 12:17:26
Format: wphtml
Title: Imagine you want to launch...

Imagine you want to launch a web browser from within your program and make it go to a specific site. You can do it the easy way: <PRE>void LaunchIE(char *site)&#013;&#010;{&#013;&#010;    ShellExecute( GetDesktopWindow(), "", "iexplore", site, NULL, SW_SHOWNORMAL );&#013;&#010;}&#013;&#010;</PRE>There's one problem with this code: it doesn't run on Windows 95 and 98 and those are still very popular. Fortunately, there is another way to do almost the same: <PRE>HANDLE JustCreateProcess(char *cmd, char *dir)&#013;&#010;{&#013;&#010;  PROCESS_INFORMATION ProcInfo={0,};&#013;&#010;  STARTUPINFO StartUp={0,};&#013;&#010;  StartUp.cb=sizeof(StartUp);&#013;&#010;  if (!CreateProcess(NULL, cmd, NULL, NULL, FALSE, 0, NULL, dir, &#013;&#010;&amp;StartUp, &amp;ProcInfo))&#013;&#010;    return NULL;&#013;&#010;  if (NULL != ProcInfo.hThread) CloseHandle( ProcInfo.hThread );&#013;&#010;  return ProcInfo.hProcess;&#013;&#010;}&#013;&#010;&#013;&#010;void LaunchIE(char *site)&#013;&#010;{&#013;&#010;  assert(site);&#013;&#010;  std::string fullStr( "c:\Program Files\Internet Explorer\IEXPLORE.EXE" );&#013;&#010;  fullStr.append( " " );&#013;&#010;  fullStr.append( site );&#013;&#010;  HANDLE hProc;&#013;&#010;  hProc = JustCreateProcess( (char*) fullStr.c_str(), "c:\Program Files\Internet Explorer" );&#013;&#010;  if (hProc) CloseHandle(hProc);&#013;&#010;}&#013;&#010;</PRE>